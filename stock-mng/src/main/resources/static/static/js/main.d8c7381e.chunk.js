(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{119:function(e,t,a){e.exports=a(209)},124:function(e,t,a){},209:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(7),s=a.n(c),o=(a(124),a(10)),u=a.n(o),i=a(17),l=a(25),p=a(26),d=a(29),m=a(27),h=a(30),f=a(212),b=a(215),v=a(213),w=a(210),k=a(211),g=a(39),E=a(9),O=a(214),y=function(e){return Math.min(99,Math.max(0,e))};var C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){var t;e.target.value?(t=e.target.value,isNaN(t)||parseInt(t)!==+t||a.props.onChange(y(+e.target.value))):a.props.onChange(0)},a.increment=function(e){var t=a.props.value+e;isNaN(t)&&(t=0),a.props.onChange(y(t))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"number-component"},r.a.createElement(g.a,{disabled:this.props.disabled,shape:"circle",onClick:function(){return e.increment(-1)}},r.a.createElement(E.a,{type:"minus"})),r.a.createElement("span",null,r.a.createElement(O.a,{disabled:this.props.disabled,className:"input",value:this.props.value,onChange:this.onChange})),r.a.createElement(g.a,{disabled:this.props.disabled,shape:"circle",onClick:function(){return e.increment(1)}},r.a.createElement(E.a,{type:"plus"})))}}]),t}(n.Component),x=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e,a))).order=Object(i.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),e.prev=1,e.next=4,n.props.onOrder(n.state.orderCount);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:n.setState({orderCount:0,loading:!1});case 9:case"end":return e.stop()}},e,null,[[1,6]])})),n.state={orderCount:0,loading:!1},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"stock-item"},r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"name"},this.props.name),r.a.createElement("div",{className:"price"},"\u5355\u4ef7: \xa5",(+this.props.price/100).toFixed(2)),this.props.loading?r.a.createElement("div",{className:"purchased"},"\xa0",r.a.createElement(w.a,{size:"small"})):r.a.createElement("div",{className:"purchased"},"\u5df2\u8d2d: ",this.props.ownedCount||0," \u4ef6")),r.a.createElement("div",{className:"side"},r.a.createElement(C,{value:this.state.orderCount,onChange:function(t){return e.setState({orderCount:t})},disabled:this.state.loading}),r.a.createElement(k.a,{placement:"left",title:"\u786e\u5b9a\u8981\u8ba2\u8d2d".concat(this.state.orderCount,"\u4ef6 ").concat(this.props.name," \u5417\uff1f (\u603b\u4ef7").concat((this.state.orderCount*this.props.price/100).toFixed(2),"\u5143)"),className:this.state.orderCount?"":"disabled",onConfirm:this.order},r.a.createElement(g.a,{className:"purchase-button",type:"primary",disabled:!this.state.orderCount,loading:this.state.loading},"\u8ba2\u8d2d"))))}}]),t}(n.Component),j=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e,a))).updateCurrent=function(){n.state.current!==n.props.balance&&(Math.abs(n.state.current-n.props.balance)<.01?n.setState({current:n.props.balance}):n.setState({current:n.state.current+(n.props.balance-n.state.current)/10}))},n.state={current:n.props.balance},setInterval(n.updateCurrent,10),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"balance-component"},"\u53ef\u7528\u4f59\u989d ",null===this.props.balance?r.a.createElement("span",null,"..."):r.a.createElement("span",null,"\xa5 ",(+this.state.current/100).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")))}}]),t}(n.Component),N=a(116),S=a.n(N),I=a(56),U=a.n(I);function q(e){if(!1===e.success)throw new Error("result.success===false")}function B(e){return"/"===window.backendUrl&&(window.backendUrl=window.location.origin),window.backendUrl.endsWith("/")&&(window.backendUrl=window.backendUrl.substr(0,window.backendUrl.length-1)),e.startsWith("/")||(e="/"+e),window.backendUrl+e}window.backendUrl=window.backendUrl||"http://127.0.0.1:8080";var F={createUser:function(){var e=Object(i.a)(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.post(B("/createUser"),{userName:t});case 3:q(e.sent.data),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),b.a.error("Failed to create user: "+e.t0.message),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),query:function(){var e=Object(i.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.post(B("/query"),{userName:t});case 3:return q(a=e.sent.data),e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),b.a.error("Failed to query stock: "+e.t0.message),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),queryBalance:function(){var e=Object(i.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.post(B("/queryBalance"),{userName:t});case 3:return q(a=e.sent.data),e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),b.a.error("Failed to query balance: "+e.t0.message),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),purchase:function(){var e=Object(i.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.post(B("/purchase"),{userName:t,productCode:a,count:n});case 3:return q(r=e.sent.data),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),b.a.error("Failed to purchase: "+e.t0.message),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n){return e.apply(this,arguments)}}()},M=f.a.Header,A=f.a.Content,D=f.a.Footer,H=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e,a))).refreshStockItems=Object(i.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.query(localStorage.userName);case 2:(t=e.sent).forEach(function(e){return e.loading=!1}),n.setState({stockItems:t});case 5:case"end":return e.stop()}},e)})),n.refreshBalance=Object(i.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.queryBalance(localStorage.userName);case 2:t=e.sent,n.setState({balance:t.balance});case 4:case"end":return e.stop()}},e)})),n.onOrder=function(){var e=Object(i.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.purchase(localStorage.userName,t.productCode,a);case 2:b.a.success("\u606d\u559c\uff0c\u8ba2\u8d2d\u6210\u529f"),n.setState({balance:n.state.balance-t.price*a}),t.ownedCount+=a,t.loading=!0,n.setState({}),n.refreshStockItems(),n.refreshBalance();case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),n.state={balance:null,stockItems:null},setInterval(function(){n.refreshStockItems(),n.refreshBalance()},3e3),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initUser();case 2:return this.refreshBalance(),e.next=5,this.refreshStockItems();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(f.a,{className:"layout"},r.a.createElement(M,null,r.a.createElement("div",{className:"logo"},"KubeCon DEMO")),r.a.createElement(A,{style:{padding:"0 50px"}},r.a.createElement(v.a,{style:{margin:"16px 0"}},r.a.createElement(v.a.Item,null,"Home"),r.a.createElement(v.a.Item,null,"\u5e93\u5b58\u7ba1\u7406")),r.a.createElement("div",{style:{background:"#fff",padding:24,minHeight:280}},!this.state.stockItems&&r.a.createElement("div",{className:"spin-div"},r.a.createElement(w.a,null)),!!this.state.stockItems&&this.state.stockItems.map(function(t){return r.a.createElement("div",null,r.a.createElement(x,{key:t.productCode,name:t.name,ownedCount:t.ownedCount,price:t.price,loading:t.loading,onOrder:function(a){return e.onOrder(t,a)}}))}))),r.a.createElement(j,{balance:this.state.balance}),r.a.createElement(D,{style:{textAlign:"center"}},"Alipay \xa92019 / a KubeCon DEMO"))}}],[{key:"initUser",value:function(){var e=Object(i.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.userName){e.next=6;break}return t=S()(),e.next=5,F.createUser(t);case 5:localStorage.userName=t;case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}]),t}(n.Component);s.a.render(r.a.createElement(H,null),document.getElementById("root"))}},[[119,1,2]]]);
//# sourceMappingURL=main.d8c7381e.chunk.js.map